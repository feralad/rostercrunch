<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Roster Crunch - 9&nbsp; Project Process</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./10_project_reflections.html" rel="next">
<link href="./08_dynasty_thoughts.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./09_project_process.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Project Process</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./pic_RosterCrunch_Logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Roster Crunch</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hello!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_storytime.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Story Time</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_overview_context.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Overview and Context</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_woba_grades_graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Simple wOBA Grades</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_woba_grades_batters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">wOBA Grades</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_woba_grades_pitchers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">wOBA Against Grades</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_career_woba.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Career wOBA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Correlation and Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_dynasty_thoughts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Dynasty Thoughts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_project_process.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Project Process</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_project_reflections.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Project Reflections</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-importing" id="toc-data-importing" class="nav-link active" data-scroll-target="#data-importing"><span class="header-section-number">9.1</span> Data Importing</a>
  <ul class="collapse">
  <li><a href="#readr-package" id="toc-readr-package" class="nav-link" data-scroll-target="#readr-package">readr package</a></li>
  </ul></li>
  <li><a href="#data-exploration" id="toc-data-exploration" class="nav-link" data-scroll-target="#data-exploration"><span class="header-section-number">9.2</span> Data Exploration</a>
  <ul class="collapse">
  <li><a href="#skimr-package" id="toc-skimr-package" class="nav-link" data-scroll-target="#skimr-package">skimr package</a></li>
  </ul></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning"><span class="header-section-number">9.3</span> Data Cleaning</a>
  <ul class="collapse">
  <li><a href="#stringr-lubridate-packages" id="toc-stringr-lubridate-packages" class="nav-link" data-scroll-target="#stringr-lubridate-packages">stringr &amp; lubridate packages</a></li>
  </ul></li>
  <li><a href="#data-transformation-analysis" id="toc-data-transformation-analysis" class="nav-link" data-scroll-target="#data-transformation-analysis"><span class="header-section-number">9.4</span> Data Transformation &amp; Analysis</a>
  <ul class="collapse">
  <li><a href="#dplyr-package" id="toc-dplyr-package" class="nav-link" data-scroll-target="#dplyr-package">dplyr package</a></li>
  <li><a href="#janitor-package" id="toc-janitor-package" class="nav-link" data-scroll-target="#janitor-package">janitor package</a></li>
  </ul></li>
  <li><a href="#data-visualization" id="toc-data-visualization" class="nav-link" data-scroll-target="#data-visualization"><span class="header-section-number">9.5</span> Data Visualization</a>
  <ul class="collapse">
  <li><a href="#gt-package" id="toc-gt-package" class="nav-link" data-scroll-target="#gt-package">gt package</a></li>
  <li><a href="#ggplot2-ggpmisc-hrbrthemes-packages" id="toc-ggplot2-ggpmisc-hrbrthemes-packages" class="nav-link" data-scroll-target="#ggplot2-ggpmisc-hrbrthemes-packages">ggplot2 + ggpmisc + hrbrthemes packages</a></li>
  </ul></li>
  <li><a href="#sharing" id="toc-sharing" class="nav-link" data-scroll-target="#sharing"><span class="header-section-number">9.6</span> Sharing</a>
  <ul class="collapse">
  <li><a href="#quarto" id="toc-quarto" class="nav-link" data-scroll-target="#quarto">Quarto</a></li>
  <li><a href="#github" id="toc-github" class="nav-link" data-scroll-target="#github">GitHub</a></li>
  </ul></li>
  <li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources"><span class="header-section-number">9.7</span> Resources</a>
  <ul class="collapse">
  <li><a href="#google-analytics-certificate-program" id="toc-google-analytics-certificate-program" class="nav-link" data-scroll-target="#google-analytics-certificate-program">Google Analytics Certificate Program</a></li>
  <li><a href="#stack-overflow" id="toc-stack-overflow" class="nav-link" data-scroll-target="#stack-overflow">Stack Overflow</a></li>
  <li><a href="#function-reference-for-packages" id="toc-function-reference-for-packages" class="nav-link" data-scroll-target="#function-reference-for-packages">Function Reference for Packages</a></li>
  <li><a href="#package-cheatsheets" id="toc-package-cheatsheets" class="nav-link" data-scroll-target="#package-cheatsheets">Package Cheatsheets</a></li>
  <li><a href="#r-for-the-rest-of-us" id="toc-r-for-the-rest-of-us" class="nav-link" data-scroll-target="#r-for-the-rest-of-us">R for the Rest of Us</a></li>
  <li><a href="#youtube" id="toc-youtube" class="nav-link" data-scroll-target="#youtube">YouTube</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Project Process</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>If you’re curious about how this project came together, I wrote a general overview for you!</p>
<p>The short explanation is that everything you see here from the visualizations to the analysis to the writing was done in <a href="https://posit.co/download/rstudio-desktop/" target="_blank">RStudio</a> using the <a href="https://www.r-project.org/about.html" target="_blank">R programming language</a>.</p>
<p>I chose R for this project because it offered the ability to work more efficiently with a large dataset compared to more familiar software like Excel. I did consider SQL but felt like the comprehensiveness of R and its usability as an end-to-end solution would give me the nimbleness to do pretty much anything I needed to do. Oh, did I mention that R and RStudio are free and open source?!</p>
<p>The Google Data Analytics Certificate program I participated in back in 2023—which I’ll talk about in a bit—gives an overview of R, so I had some preliminary comfort from the courses. However, this was the first time I had ever done any coding in my entire life, hence why the project took me a year to complete.</p>
<p>For each of the project stages, I think it would be most helpful to speak about it tangibly by including packages that I used as well as some of my code. This is not meant to be exhaustive or to serve as any kind of example—I would warn you against that!—but simply to show how I went about completing the project. Many of these packages are part of the <a href="https://www.tidyverse.org/" target="_blank">tidyverse</a>.</p>
<section id="data-importing" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="data-importing"><span class="header-section-number">9.1</span> Data Importing</h2>
<section id="readr-package" class="level3">
<h3 class="anchored" data-anchor-id="readr-package">readr package</h3>
<p>All of the datasets I used were csv files. Within RStudio, there is an “Import Dataset” button that makes importing files easy. One of the default options for importing text files is to use the <a href="https://readr.tidyverse.org/" target="_blank">readr package</a>. The code below is the simplest version of doing this, but you can also manipulate the dataset in tons of different ways while importing depending on what is needed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>game_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"~/Downloads/retro_final_PA_1990-2020d.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If I get around to another baseball project, I want to utilize the <a href="https://billpetti.github.io/baseballr/" target="_blank">baseballr package</a>. I initially started with this package but found it a bit beyond me at the beginning of this project.</p>
</section>
</section>
<section id="data-exploration" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="data-exploration"><span class="header-section-number">9.2</span> Data Exploration</h2>
<section id="skimr-package" class="level3">
<h3 class="anchored" data-anchor-id="skimr-package">skimr package</h3>
<p>Because the primary dataset I used was so large (1.2 GB, over 6 million rows, and over 50 columns), I needed a way to get an overview of it. The <a href="https://docs.ropensci.org/skimr/" target="_blank">skimr package</a> is designed exactly for this. With a simple function like the one in my code below, I got back a summary of the dataset that told me things like what classes the different variables were (character, numeric, date, etc.), how many and what percentage of NA values there were in each column, the min and max values of each column, etc. This was particularly helpful as a starting point for data cleaning.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim_without_charts</span>(game_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-cleaning" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="data-cleaning"><span class="header-section-number">9.3</span> Data Cleaning</h2>
<section id="stringr-lubridate-packages" class="level3">
<h3 class="anchored" data-anchor-id="stringr-lubridate-packages">stringr &amp; lubridate packages</h3>
<p>The main dataset I had to clean was the dataset of Top 100 Baseball America prospects by year. This dataset was separate from the primary dataset that included all player statistics and game data, so I had to figure out a way to join them together in order to link player statistics and player prospect ranks.</p>
<p>Because the prospect dataset did not include unique player IDs, I was forced to join them together based on player names. Given that multiple players have the same names—for instance, did you know that a second <a href="https://www.baseball-reference.com/players/m/martipe03.shtml" target="_blank">Pedro Martinez</a> debuted one year after the <a href="https://www.baseball-reference.com/players/m/martipe02.shtml" target="_blank">Pedro Martinez</a> you are sure to know?—and that variations existed in spelling (AJ Burnett vs.&nbsp;A.J. Burnett as an example), this process was not as easy as it may sound.</p>
<p>At the time I was working on this, I had yet to discover the <a href="https://cran.r-project.org/web/packages/fuzzyjoin/fuzzyjoin.pdf" target="_blank">fuzzyjoin package</a> or put two and two together that I could join these datasets together based on inexact matching. This wouldn’t have made the process a breeze, but it would have significantly simplified it.</p>
<p>At least on the bright side, I got the opportunity to work with the <a href="https://stringr.tidyverse.org/" target="_blank">stringr package</a> doing character string manipulation like fixing spelling, punctuation, and capitalization differences in player names. I also used some functions from the <a href="https://lubridate.tidyverse.org/" target="_blank">lubridate package</a> to make sure dates were formatted uniformly. One example of many passes of manipulations is shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># changing two misspellings (fun players!): Carlos Gonzales(z), Miguel Teje(a)da</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># changing all caps TEAM to Team</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># changing YEAR (numeric class) to year with date (date class)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>top_prospect_rankings <span class="ot">&lt;-</span> top_prospect_rankings <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"PLAYER_NAME"</span> <span class="ot">=</span> <span class="fu">str_replace</span>(PLAYER_NAME, <span class="st">"Carlos Gonzales"</span>, </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"Carlos Gonzalez"</span>),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">"PLAYER_NAME"</span> <span class="ot">=</span> <span class="fu">str_replace</span>(PLAYER_NAME, <span class="st">"Miguel Tejeda"</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"Miguel Tejada"</span>),</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">"TEAM"</span> <span class="ot">=</span> <span class="fu">str_to_title</span>(top_prospect_rankings<span class="sc">$</span>TEAM),</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">"YEAR"</span> <span class="ot">=</span> lubridate<span class="sc">::</span><span class="fu">ymd</span>(YEAR, <span class="at">truncated =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-transformation-analysis" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="data-transformation-analysis"><span class="header-section-number">9.4</span> Data Transformation &amp; Analysis</h2>
<p>Now for the exciting packages!</p>
<section id="dplyr-package" class="level3">
<h3 class="anchored" data-anchor-id="dplyr-package">dplyr package</h3>
<p>By far and away, my favorite and most used package was <a href="https://dplyr.tidyverse.org/" target="_blank">dplyr</a>, an extremely popular package in the world of data analysis. The name is meant to mean “d” for data and the “plyr” for plier, as in manipulating data with a tool like a plier. Even in the code above, mutate is a function from the dplyr package.</p>
<p>In a large sense, I took data out of the play-by-play dataset and moved it into a flat summary table with one row containing statistics and other relevant data for each player. dplyr made this possible.</p>
<p>One of my most crucial steps was to convert the wOBA value for every plate appearance for every batter and pitcher into a “rolling wOBA” or “rolling wOBA Against” data column. This took the cumulative wOBA or wOBA Against for a player up to that specific plate appearance (or batter faced) in their career. It enabled me to determine what a batter’s wOBA was at 150 plate appearances or a pitcher’s wOBA Against at 860 batters faced as an example. The code below uses dplyr functions that I used over and over—group_by, filter, mutate, relocate, ungroup—and also some base R functions—cumsum and seq_along. ungroup is still a bit confusing to me!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate rolling wOBA for batters</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>bat_wOBA_log_debut_1990_on <span class="ot">&lt;-</span> career_wOBA_log_w_biodates <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(BAT_ID) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(BAT_DEBUT <span class="sc">&gt;</span> <span class="st">"1990-04-08"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ROLLING_WOBA_BAT =</span> <span class="fu">cumsum</span>(EVENT_WOBA) <span class="sc">/</span> <span class="fu">seq_along</span>(EVENT_WOBA)) <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(ROLLING_WOBA_BAT, <span class="at">.after =</span> CAREER_PA_WOBA_NUM) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>My understanding is that dplyr is very similar to SQL (structured query language). It enables you to do SQL-like queries like this one which combed through the 71,080 baseball games in the dataset to find which ones ended in back-to-back home runs. This was probably the most fun code I wrote!</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-5"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-5-1"><a href="#annotated-cell-5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find the number of games ending in back-to-back home runs</span></span>
<span id="annotated-cell-5-2"><a href="#annotated-cell-5-2" aria-hidden="true" tabindex="-1"></a>back_to_back_home_run_game_endings <span class="ot">&lt;-</span> game_data <span class="sc">%&gt;%</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-5-3" class="code-annotation-target"><a href="#annotated-cell-5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(row_idx, GAME_ID, PARK, DATE, HOME_TEAM_ID, AWAY_TEAM_ID, INNING,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-5-4" class="code-annotation-target"><a href="#annotated-cell-5-4" aria-hidden="true" tabindex="-1"></a>         BAT_NAME, PIT_NAME, EVENT_TX, HIT_VAL, EVENT_RUNS, PA_IND) <span class="sc">%&gt;%</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-5-5" class="code-annotation-target"><a href="#annotated-cell-5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">ymd</span>(DATE), row_idx) <span class="sc">%&gt;%</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-5-6" class="code-annotation-target"><a href="#annotated-cell-5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="at">PA_IND =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="annotated-cell-5-7"><a href="#annotated-cell-5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GAME_ID) <span class="sc">%&gt;%</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-5-8" class="code-annotation-target"><a href="#annotated-cell-5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_tail</span>(<span class="at">n =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="6" onclick="event.preventDefault();">6</a><span id="annotated-cell-5-9" class="code-annotation-target"><a href="#annotated-cell-5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(HIT_VAL <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="annotated-cell-5-10"><a href="#annotated-cell-5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GAME_ID) <span class="sc">%&gt;%</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="7" onclick="event.preventDefault();">7</a><span id="annotated-cell-5-11" class="code-annotation-target"><a href="#annotated-cell-5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_count</span>(GAME_ID) <span class="sc">%&gt;%</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="8" onclick="event.preventDefault();">8</a><span id="annotated-cell-5-12" class="code-annotation-target"><a href="#annotated-cell-5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">!=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="annotated-cell-5-13"><a href="#annotated-cell-5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">ymd</span>(DATE), row_idx)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-5" data-target-annotation="1">1</dt>
<dd>
<span data-code-lines="3" data-code-cell="annotated-cell-5" data-code-annotation="1">Pick only these columns from the dataset.</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="2">2</dt>
<dd>
<span data-code-lines="4" data-code-cell="annotated-cell-5" data-code-annotation="2">%&gt;% is called the forward pipe operator, which essentially says, “Do this %&gt;% then do this.”</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="3">3</dt>
<dd>
<span data-code-lines="5" data-code-cell="annotated-cell-5" data-code-annotation="3">Arrange sequentially by date and order of events within each game.</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="4">4</dt>
<dd>
<span data-code-lines="6" data-code-cell="annotated-cell-5" data-code-annotation="4">Filter out non-plate appearance events like stolen bases.</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="5">5</dt>
<dd>
<span data-code-lines="8" data-code-cell="annotated-cell-5" data-code-annotation="5">Select only the last two plate appearances of each game.</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="6">6</dt>
<dd>
<span data-code-lines="9" data-code-cell="annotated-cell-5" data-code-annotation="6">Filter for only home runs (HR).</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="7">7</dt>
<dd>
<span data-code-lines="11" data-code-cell="annotated-cell-5" data-code-annotation="7">Count how many times the game ID appeared (once (one HR) or twice (bingo!)).</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="8">8</dt>
<dd>
<span data-code-lines="12" data-code-cell="annotated-cell-5" data-code-annotation="8">Filter for games with more than one HR in last two plate appearances.</span>
</dd>
</dl>
</div>
</div>
</section>
<section id="janitor-package" class="level3">
<h3 class="anchored" data-anchor-id="janitor-package">janitor package</h3>
<p>As amazing as dplyr is, it’s not the best tool for every single task. This is something I learned the hard way when trying to create cross-tabulations to find the value for the combination of two variables (think pivot tables if you’re more familiar with Excel) using a combination of dplyr functions. I stumbled across the <a href="https://cran.r-project.org/web/packages/janitor/vignettes/janitor.html" target="_blank">janitor package</a>, which has a function that in one line of code will create a crosstab for you—taybl. janitor also has a number of data cleaning functions, hence the name.</p>
<p>The package also has the ability to enhance crosstabs by calculating totals and percentages within rows or columns. If you look back at my tables, this code becomes very evident. The two commas in the adorn_percentages function below might make no sense to you. They still don’t make much sense to me and trigger a warning ⚠️ triangle in RStudio. It is telling janitor to skip unused arguments in the function. The Elite:DNQ is indicating to only calculate percentages for the Elite column through the DNQ column, not a “Total” column at the end, which I wanted to preserve with the numeric count.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create crosstabs for batters in a list, 150 PA, by prospect rank</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>batter_woba_grade_crosstabs_150_list <span class="ot">&lt;-</span> all_batter_career_data_by_ID <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(BAT_DEBUT <span class="sc">&lt;</span> <span class="st">"2011-01-01"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(FIRST_150_WOBA_GRADE, POST_150_WOBA_GRADE, PROSPECT_RANK_GROUP) <span class="sc">%&gt;%</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_percentages</span>(<span class="st">"row"</span>,,Elite<span class="sc">:</span>DNQ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-visualization" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="data-visualization"><span class="header-section-number">9.5</span> Data Visualization</h2>
<section id="gt-package" class="level3">
<h3 class="anchored" data-anchor-id="gt-package">gt package</h3>
<p>I utilized the <a href="https://yihui.org/knitr/" target="_blank">knitr package</a> to create some basic tables (referred to as kables), but the main tables you saw with different colors were created using the <a href="https://gt.rstudio.com/" target="_blank">gt package</a>. The gt package allows for table customization down to the minutest level, and the tables can be as beautiful as you would like to make them.</p>
<p>This code also includes the first function I wrote, essentially creating a theme I could use for other similar gt tables. R for the Rest of Us, which I talk about more below, has a <a href="https://www.youtube.com/watch?v=YzmLB2z9whw" target="_blank">short video</a> on how to do this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create gt table of batter wOBA grade percentages, 150 PA, prospects 1 - 25</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>batter_woba_grade_crosstabs_150_list<span class="sc">$</span><span class="st">`</span><span class="at">1 - 25</span><span class="st">`</span> <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">rowname_col =</span> <span class="st">"FIRST_150_WOBA_GRADE"</span>, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">groupname_col =</span> <span class="st">"PROSPECT_RANK_GROUP"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">md</span>(<span class="st">"**Percentage of Batters by wOBA Grades**"</span>), </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Prospect Rank: 1 to 25 | First &amp; Post 150 Plate Appearances"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt_crosstab_theme_fn_data_color</span>()</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>gt_crosstab_theme_fn_data_color <span class="ot">&lt;-</span> <span class="cf">function</span>(gt_tbl) {</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  gt_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_footnote</span>(</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">footnote =</span> <span class="st">"*Percentages are rounded..."</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_stubhead</span>(</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"Initial wOBA"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_spanner</span>(</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">"Remaining Career wOBA"</span>, <span class="at">columns =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_style</span>(</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>), </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">locations =</span> <span class="fu">cells_stub</span>(<span class="at">rows =</span> <span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_style</span>(</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">style =</span> <span class="st">"italic"</span>), </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">locations =</span> <span class="fu">list</span>(<span class="fu">cells_body</span>(<span class="at">columns =</span> Total), </span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">cells_column_labels</span>(<span class="at">columns =</span> Total))) <span class="sc">%&gt;%</span> </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_label</span>(</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Below Average</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Below"</span>, </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">Average =</span> <span class="st">"Avg."</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_align</span>(</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_align</span>(</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">align =</span> <span class="st">"center"</span>,</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_width</span>(</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span> <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">130</span>),</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">~</span> <span class="fu">px</span>(<span class="dv">50</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sub_missing</span>(</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">missing_text =</span> <span class="st">"---"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data_color</span>(</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> <span class="fu">everything</span>(), </span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">direction =</span> <span class="st">"row"</span>, </span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>,</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"numeric"</span>, </span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">palette =</span> <span class="st">"plasma"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_percent</span>(</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>,</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> <span class="fu">everything</span>(), </span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">drop_trailing_zeros =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fmt_percent</span>(</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">c</span>(<span class="sc">!</span><span class="fu">starts_with</span>(<span class="st">"Total"</span>) <span class="sc">&amp;</span> <span class="fu">where</span>(<span class="sc">~</span> <span class="fu">is.numeric</span>(.))),</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">decimals =</span> <span class="dv">0</span>)</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ggplot2-ggpmisc-hrbrthemes-packages" class="level3">
<h3 class="anchored" data-anchor-id="ggplot2-ggpmisc-hrbrthemes-packages">ggplot2 + ggpmisc + hrbrthemes packages</h3>
<p>Data analysis without data visualization is nearly impossible to convey or do. Good visualizations help simplify thousands or millions of data points into something understandable within 5 to 10 seconds. This is why packages for making different types of plots, graphs, charts, etc., like the <a href="https://ggplot2.tidyverse.org/" target="_blank">ggplot2 package</a> are so popular. All of my plots were done with the ggplot2 package.</p>
<p>As an extension of ggplot2, the <a href="https://cran.rstudio.com/web/packages/ggpmisc/ggpmisc.pdf" target="_blank">ggpmisc package</a> includes helpful functions like stat_correlation, which calculates the correlation values and annotates the plot with those values.</p>
<p>Additionally, I used the ipsum theme from the hrbrthemes package for all plots, which in my opinion is a major upgrade to the standard themes ggplot2 provides. The ipsum theme is as simple as loading the package and adding one line of code! Some of the additional themes through the <a href="https://github.com/hrbrmstr/hrbrthemes" target="_blank">package</a> may require downloading specific fonts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-8"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-8-1"><a href="#annotated-cell-8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot first 300 &amp; post 300 PA for batters, add correlation, linear model</span></span>
<span id="annotated-cell-8-2"><a href="#annotated-cell-8-2" aria-hidden="true" tabindex="-1"></a>all_batter_career_data_by_ID <span class="sc">%&gt;%</span></span>
<span id="annotated-cell-8-3"><a href="#annotated-cell-8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(BAT_DEBUT <span class="sc">&lt;</span>  <span class="st">"2011-01-01"</span> <span class="sc">&amp;</span> CAREER_TOTAL_PA <span class="sc">&gt;=</span> <span class="dv">1800</span>) <span class="sc">%&gt;%</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-8-4" class="code-annotation-target"><a href="#annotated-cell-8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> POST_300_WOBA, <span class="at">y =</span> FIRST_300_WOBA)) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-8-5" class="code-annotation-target"><a href="#annotated-cell-8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> PROSPECT_RANK_GROUP)) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-8-6" class="code-annotation-target"><a href="#annotated-cell-8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-8-7" class="code-annotation-target"><a href="#annotated-cell-8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_correlation</span>(<span class="fu">use_label</span>(<span class="fu">c</span>(<span class="st">"R"</span>, <span class="st">"R2"</span>, <span class="st">"P"</span>))) <span class="sc">+</span></span>
<span id="annotated-cell-8-8"><a href="#annotated-cell-8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> signs<span class="sc">::</span><span class="fu">signs_format</span>(<span class="at">accuracy =</span> .<span class="dv">001</span>, </span>
<span id="annotated-cell-8-9"><a href="#annotated-cell-8-9" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">trim_leading_zeros =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span> </span>
<span id="annotated-cell-8-10"><a href="#annotated-cell-8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> signs<span class="sc">::</span><span class="fu">signs_format</span>(<span class="at">accuracy =</span> .<span class="dv">001</span>, </span>
<span id="annotated-cell-8-11"><a href="#annotated-cell-8-11" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">trim_leading_zeros =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span> </span>
<span id="annotated-cell-8-12"><a href="#annotated-cell-8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#1192e8"</span>, </span>
<span id="annotated-cell-8-13"><a href="#annotated-cell-8-13" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"#fa4d56"</span>, </span>
<span id="annotated-cell-8-14"><a href="#annotated-cell-8-14" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"#002d9c"</span>, </span>
<span id="annotated-cell-8-15"><a href="#annotated-cell-8-15" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"#009d9a"</span>, </span>
<span id="annotated-cell-8-16"><a href="#annotated-cell-8-16" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"#a56eff"</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-8-17"><a href="#annotated-cell-8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Linear Correlation in wOBA for First &amp; Post 300 PAs"</span>, </span>
<span id="annotated-cell-8-18"><a href="#annotated-cell-8-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Includes All Batters..."</span>) <span class="sc">+</span> </span>
<span id="annotated-cell-8-19"><a href="#annotated-cell-8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="at">label =</span> <span class="st">"Post 300 PA wOBA"</span>) <span class="sc">+</span> </span>
<span id="annotated-cell-8-20"><a href="#annotated-cell-8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="at">label =</span> <span class="st">"First 300 PA wOBA"</span>) <span class="sc">+</span> </span>
<span id="annotated-cell-8-21"><a href="#annotated-cell-8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="annotated-cell-8-22"><a href="#annotated-cell-8-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> </span>
<span id="annotated-cell-8-23"><a href="#annotated-cell-8-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">guide_legend</span>(</span>
<span id="annotated-cell-8-24"><a href="#annotated-cell-8-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Prospect Rank Group"</span>)) <span class="sc">+</span> </span>
<span id="annotated-cell-8-25"><a href="#annotated-cell-8-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="annotated-cell-8-26"><a href="#annotated-cell-8-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-8" data-target-annotation="1">1</dt>
<dd>
<span data-code-lines="4" data-code-cell="annotated-cell-8" data-code-annotation="1">Define x and y values.</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="2">2</dt>
<dd>
<span data-code-lines="5" data-code-cell="annotated-cell-8" data-code-annotation="2">Define desired plot type (point for scatterplot).</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="3">3</dt>
<dd>
<span data-code-lines="6" data-code-cell="annotated-cell-8" data-code-annotation="3">Optional: Add another plot to the existing plot (linear model).</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="4">4</dt>
<dd>
<span data-code-lines="7" data-code-cell="annotated-cell-8" data-code-annotation="4">Annotate the plot with these specific statistics.</span>
</dd>
</dl>
</div>
</div>
</section>
</section>
<section id="sharing" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="sharing"><span class="header-section-number">9.6</span> Sharing</h2>
<section id="quarto" class="level3">
<h3 class="anchored" data-anchor-id="quarto">Quarto</h3>
<p>To get my project “out there” for all of you to read, I chose Quarto, a publishing system which is built into RStudio as well as other “integrated development environments.” It’s also programming-language agnostic, so Python, etc., work inside it too.</p>
<p>While my project is not really a book, technically you are reading a Quarto Book. My favorite thing about Quarto is that hardly any customization is needed for it to look aesthetic. The three things that required me to do a bit more digging were:</p>
<section id="loading-packages-data" class="level4">
<h4 class="anchored" data-anchor-id="loading-packages-data">Loading Packages &amp; Data</h4>
<p>I assumed since I had already loaded the packages and data I was using in RStudio that I did not need to load them in my different Quarto files (.qmd files), which together comprise the Quarto Book. After some head-scratching and Googling, I learned that I <strong>did</strong> need to load them again. Each page of this website (Quarto book) is its own qmd file, so I repeated similar code below in each. I didn’t find a way to specify this globally so that it wouldn’t have to be repeated in each file, but I’m sure there is a way.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load necessary packages</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load necessary data</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"crosstabs.RData"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"summary_tables.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="execution-options" class="level4">
<h4 class="anchored" data-anchor-id="execution-options">Execution Options</h4>
<p>Since this project was more data journalism than scientific publishing, it wasn’t necessary for me to bog it down with chunk after chunk of code. This execution option specified in the .yml (master) file of the Quarto project essentially tells Quarto to run the code but not to include the code itself in the output. This can be overridden manually for specific code chunks with <code>echo: true</code>, which is how you are seeing code on this page.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>execute<span class="sc">:</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  echo<span class="sc">:</span> false</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="panel-tabsets" class="level4">
<h4 class="anchored" data-anchor-id="panel-tabsets">Panel Tabsets</h4>
<p>If my project wasn’t already unreadable on its own merits, it would have been far more so without the functionality of panel tabsets. I used these to give you as the reader the ability to toggle between visualizations, for example between charts focused on 150 plate appearances versus 600 plate appearances. These are extremely easy to add with the following code. The <code>::: panel-tabset</code> and <code>:::</code> enclose the panel, and the <code>##</code> serve as the different headers for each tab.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="sc">:::</span> panel<span class="sc">-</span>tabset</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 150 PA</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>code...</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 600 PA</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>code...</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="sc">:::</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="github" class="level3">
<h3 class="anchored" data-anchor-id="github">GitHub</h3>
<p>I chose GitHub Pages to “host” my Quarto Book. If you look at the URL, this is apparent. For full transparency, I probably could not repeat this without re-referencing a tutorial. I believe <a href="https://www.youtube.com/watch?v=QLFc9gw_Hfs" target="_blank">this</a> was the most helpful resource I found or the one that made the most sense to me.</p>
</section>
</section>
<section id="resources" class="level2" data-number="9.7">
<h2 data-number="9.7" class="anchored" data-anchor-id="resources"><span class="header-section-number">9.7</span> Resources</h2>
<section id="google-analytics-certificate-program" class="level3">
<h3 class="anchored" data-anchor-id="google-analytics-certificate-program">Google Analytics Certificate Program</h3>
<p>This project served as my capstone project for the Google Data Analytics Certificate Program. They have some default projects you can pick, but I definitely wanted to do something of greater interest to me to help stay motivated.</p>
<p>I found the program to be a solid overview of data analytics and key tools. From there, I felt more confident to branch out into more specific areas and tools that I had yet to work with. Since I love the big picture, I found <a href="https://www.youtube.com/watch?v=Jye81eSts2c" target="_blank">their breakdown</a> of the data analysis process extremely helpful. This was my north star throughout my project.</p>
<ul>
<li>Ask</li>
<li>Prepare</li>
<li>Process</li>
<li>Analyze</li>
<li>Share</li>
<li>Act</li>
</ul>
</section>
<section id="stack-overflow" class="level3">
<h3 class="anchored" data-anchor-id="stack-overflow">Stack Overflow</h3>
<p>When I first started my project, the only code examples I had were from the certificate program. As I plodded along, there were hundreds of times where I knew what end result I wanted (for example, a new column of data) but didn’t know what code to write to get there. Stack Overflow was enormously helpful in getting closer to the specific code I needed as long as I could formulate a question that was in the ballpark of what I was looking for. Of the hundreds of questions I had, I only wound up having to ask a <a href="https://stackoverflow.com/questions/77520767/factor-levels-out-of-order-in-tibble" target="_blank">minor one</a> where I couldn’t find an existing answer. That’s quite a testament to the amount of information available and incredible credit to the individuals who provide answers. Where do you they find the time?!</p>
<p>I recognize that AI tools may have reached the point of being a more efficient tool than combing through sites like Stack Overflow. When I first started my project, I don’t think Chat-GPT or other similar tools had quite caught on like they have today. It may have been a poor decision, but I decided that I wasn’t going to use AI tools for this project. This was primarily because I felt like having to struggle a bit, figure things out more manually, etc., would help me acquire a deeper understanding of the concepts than having code more auto-generated. I also felt like I wouldn’t be able to properly validate if the AI-generated solutions had errors or not.</p>
</section>
<section id="function-reference-for-packages" class="level3">
<h3 class="anchored" data-anchor-id="function-reference-for-packages">Function Reference for Packages</h3>
<p>For all the packages I used, the function reference/reference manual was enormously helpful to get my code to work and accomplish the goals of my project. <a href="https://dplyr.tidyverse.org/reference/index.html" target="_blank">Here</a> is the manual for dplyr as an example.</p>
<p>If you click on a specific function, it tells you what exactly must and can be included (referred to as arguments). They also provide examples, which I found even more helpful.</p>
<p>If I could go back, I would probably read beforehand through the different functions in dplyr and the other core packages I used, as I had times where I stumbled upon a function too late—add_count() is one example. It’s hard to know all the functions you need beforehand, but especially for dplyr, this would have made my life easier.</p>
<p>From the package website, there is typically a link to GitHub, which has an “Issues” tab that can be helpful if you feel like something isn’t working exactly as expected—<a href="https://github.com/rstudio/gt/issues" target="_blank">gt package example</a>.</p>
</section>
<section id="package-cheatsheets" class="level3">
<h3 class="anchored" data-anchor-id="package-cheatsheets">Package Cheatsheets</h3>
<p>I believe the ggplot2 package is one of the most downloaded packages from R’s package repository. With that, I suspect it is also one of the most popular <a href="https://ggplot2.tidyverse.org/#cheatsheet" target="_blank">cheatsheets</a>. While the function reference gets to a more helpful level of detail, these cheatsheets provide a bird’s eye everything a package can do. The ggplot2 cheatsheet is great because it gives you a sense of all the data visualizations that are possible and the different components of plots. Not every package has a cheatsheet, but it’s a must-use when available.</p>
</section>
<section id="r-for-the-rest-of-us" class="level3">
<h3 class="anchored" data-anchor-id="r-for-the-rest-of-us">R for the Rest of Us</h3>
<p>I’m not sure where I first heard about <a href="https://rfortherestofus.com/" target="_blank">R for the Rest of Us</a>, but I highly recommend them if you are new to coding and interested in R. I’ve yet to take any of their full courses and didn’t do their R in 3 Months despite strongly considering it, but even signing up for their emails, listening to their podcast, and watching their shorter YouTube videos has been a huge help. From learning of new packages to making visualizations look prettier to improving workflows, they have a lot to offer. The best part about it is that they gear themselves towards folks with a non-coding background.</p>
</section>
<section id="youtube" class="level3">
<h3 class="anchored" data-anchor-id="youtube">YouTube</h3>
<p>Some channels I found helpful included <a href="https://www.youtube.com/@Riffomonas" target="_blank">Riffomonas Project</a>, <a href="https://www.youtube.com/@EquitableEquations" target="_blank">Equitable Equations</a>, and <a href="https://www.youtube.com/@PositPBC" target="_blank">Posit PBC</a>—particularly <a href="https://www.youtube.com/watch?v=i2mdxfvm_VY&amp;list=PL9HYL-VRX0oQI8fVioFxMTBrViFnRX_Df" target="_blank">Quarto-specific videos</a>. On the statistics side of things, I joined the <a href="https://www.youtube.com/@statquest" target="_blank">StatQuest</a> throng to refresh and check my understanding of statistical concepts.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./08_dynasty_thoughts.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Dynasty Thoughts</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./10_project_reflections.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Project Reflections</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>