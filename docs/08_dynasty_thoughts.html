<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Roster Crunch - 8&nbsp; Dynasty Thoughts</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./09_project_process.html" rel="next">
<link href="./07_correlation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./08_dynasty_thoughts.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Dynasty Thoughts</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./pic_RosterCrunch_Logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Roster Crunch</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hello!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_storytime.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Story Time</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_overview_context.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Overview and Context</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_woba_grades_graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Simple wOBA Grades</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_woba_grades_batters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">wOBA Grades</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_woba_grades_pitchers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">wOBA Against Grades</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_career_woba.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Career wOBA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Correlation and Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_dynasty_thoughts.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Dynasty Thoughts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_project_process.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Project Process</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_project_reflections.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Project Reflections</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#strategy-retrospective" id="toc-strategy-retrospective" class="nav-link active" data-scroll-target="#strategy-retrospective"><span class="header-section-number">8.1</span> Strategy Retrospective</a></li>
  <li><a href="#trust-the-prospect-pedigree" id="toc-trust-the-prospect-pedigree" class="nav-link" data-scroll-target="#trust-the-prospect-pedigree"><span class="header-section-number">8.2</span> Trust the Prospect Pedigree</a>
  <ul class="collapse">
  <li><a href="#batters" id="toc-batters" class="nav-link" data-scroll-target="#batters">Batters</a></li>
  <li><a href="#pitchers" id="toc-pitchers" class="nav-link" data-scroll-target="#pitchers">Pitchers</a></li>
  </ul></li>
  <li><a href="#limit-exposure-to-unranked-prospects" id="toc-limit-exposure-to-unranked-prospects" class="nav-link" data-scroll-target="#limit-exposure-to-unranked-prospects"><span class="header-section-number">8.3</span> Limit Exposure to Unranked Prospects</a></li>
  <li><a href="#pay-little-attention-to-first-impressions" id="toc-pay-little-attention-to-first-impressions" class="nav-link" data-scroll-target="#pay-little-attention-to-first-impressions"><span class="header-section-number">8.4</span> Pay Little Attention to First Impressions</a></li>
  <li><a href="#anticipate-improvement-for-top-prospects" id="toc-anticipate-improvement-for-top-prospects" class="nav-link" data-scroll-target="#anticipate-improvement-for-top-prospects"><span class="header-section-number">8.5</span> Anticipate Improvement for Top Prospects</a></li>
  <li><a href="#respect-greatness" id="toc-respect-greatness" class="nav-link" data-scroll-target="#respect-greatness"><span class="header-section-number">8.6</span> Respect Greatness</a></li>
  <li><a href="#in-summary" id="toc-in-summary" class="nav-link" data-scroll-target="#in-summary"><span class="header-section-number">8.7</span> In Summary</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Dynasty Thoughts</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="strategy-retrospective" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="strategy-retrospective"><span class="header-section-number">8.1</span> Strategy Retrospective</h2>
<p>If you somehow attain the ability or means to time travel, please use it for a better purpose. But indulge me in a hypothetical…</p>
<p>Assume we could go back to February 1990. Our imaginary friend, Ralph, is joining a group of friends for an inaugural dynasty fantasy baseball league. We have the ability to tell him five things.</p>
<p>Of course, we could tell Ralph to scoop up players like Frank Thomas, Pedro Martinez, Albert Pujols, etc., over the coming years, but this would only net him five superstars, which may not even be enough to ever win his league.</p>
<p>Far better to teach a man to fish…</p>
<p>If we could only share five important findings from this project, what would we tell him?</p>
</section>
<section id="trust-the-prospect-pedigree" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="trust-the-prospect-pedigree"><span class="header-section-number">8.2</span> Trust the Prospect Pedigree</h2>
<p>From a probability standpoint, the higher ranked a prospect, the higher their chances of becoming good major league players as measured by wOBA or wOBA Against. wOBA and wOBA Against do not fully reflect player fantasy value, but for one statistic, it captures a lot.</p>
<section id="batters" class="level3">
<h3 class="anchored" data-anchor-id="batters">Batters</h3>
<p>Top 50 batting prospects are the best investment with a noticeable drop-off after that point.</p>
<p>Of batting prospects who make it to the major leagues, about 46% of top 25 batting prospects hit for a good to elite wOBA during their career. This percentage drops to 33% of prospects ranked 26 to 50, 22% for prospects ranked 51 to 75, and 16% for prospects ranked 76 to 100.</p>
</section>
<section id="pitchers" class="level3">
<h3 class="anchored" data-anchor-id="pitchers">Pitchers</h3>
<p>When referring to pitching prospects and pitchers, we are only referring to starting pitchers.</p>
<p>Top 25 pitching prospects are the best investment with a similar drop-off after.</p>
<p>About 41% of top 25 prospects put up a good to elite wOBA Against for their career. This percentage drops to 20% for prospects ranked 26 to 50, 18% for prospects ranked 51 to 75, and 24% for prospects ranked 76 to 100.</p>
<p>Additionally, the higher ranked a prospect, the more likely they will make it to the major leagues and remain in the league for a longer period of time.</p>
</section>
</section>
<section id="limit-exposure-to-unranked-prospects" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="limit-exposure-to-unranked-prospects"><span class="header-section-number">8.3</span> Limit Exposure to Unranked Prospects</h2>
<p>This piece of advice is likely to be controversial and requires some qualifiers.</p>
<p>The first is that this is highly dependent on league settings. Ralph tells us that he is playing in a shallow 12 team league, so this is much more applicable. In deeper leagues, unranked prospects should be valued more given that many more players are rostered.</p>
<p>The second is that there is a distinction between prospects who are just outside the top 100 rankings and prospects who miraculously make it to the major leagues. To lop them all together is not wise. Related, good batting prospects may be ranked lower based on defensive limitations.</p>
<p>The data for our years of focus show that the odds are not in unranked prospects favor. The percentage of unranked prospects who become above average major league players in wOBA/wOBA Against is about 5%. 59% of unranked batting prospects who debuted do not even reach 600 career plate appearances. 67% of unranked pitching prospects who debuted do not reach 860 career batters faced, equivalent to roughly 200 innings pitched.</p>
<p>Furthermore, the number of unranked prospects that become major league players who get picked in the first few rounds of fantasy drafts on a regular basis is almost zero.</p>
<p>In light of this, routinely using up minor league spots for players who will rarely be above average contributors at best is probably not a great strategy. Typically, managers are more prone to do this with unranked prospects who are close to debuting or recently debuted.</p>
<p>An alternative strategy is to pursue younger prospects with the potential to become top 100 prospects, although this comes with its own diminished success rates. I do not have any analysis to prove that this is a better strategy.</p>
<p>All in all, it’s best to limit exposure to unranked prospects when possible. They are the worst investment.</p>
</section>
<section id="pay-little-attention-to-first-impressions" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="pay-little-attention-to-first-impressions"><span class="header-section-number">8.4</span> Pay Little Attention to First Impressions</h2>
<p>If we look at players who played for at least roughly three full seasons, their initial rookie performance <strong>as measured by wOBA or wOBA Against</strong> tells us very little about the types of players they will become.</p>
<p>When players lose rookie eligibility—130 at-bats for batters and 50 innings pitched for pitchers—a weak positive correlation exists between their current and remaining career wOBA/wOBA Against. As they accumulate more plate appearances and innings pitched over their first full season in the major leagues, this relationship strengthens but does not become strong, especially not for pitchers.</p>
<p>At 600 plate appearances for batters, Pearson’s correlation coefficient (R) is .5 and R<sup>2</sup> is .25. At best, a full rookie season only moderately correlates with and predicts future career wOBA for batters.</p>
<p>At 860 batters faced—about 200 innings pitched—Pearson’s correlation coefficient is .25 and R<sup>2</sup> is .06. At best, a full rookie season weakly correlates with and predicts almost nothing about future career wOBA Against for pitchers.</p>
</section>
<section id="anticipate-improvement-for-top-prospects" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="anticipate-improvement-for-top-prospects"><span class="header-section-number">8.5</span> Anticipate Improvement for Top Prospects</h2>
<p>Top batting prospects grouped by rank (1 to 25, 26 to 50, 51 to 75, 76 to 100) gain an average of 9 to 15 points in wOBA after their first 150 plate appearances. They gain 5 to 10 points after their first 600 plate appearances. This may seem like very small movement, but consider that this is for each group as a whole. Obviously, some batters (and pitchers) regress as well.</p>
<p>Unranked batting prospects as a whole lose two points in wOBA after their first 150 plate appearances. They neither gain nor lose points in wOBA after their first 600 plate appearances.</p>
<p>Top pitching prospects grouped by rank shed 3 to 7 points in wOBA Against after their first 215 batters faced. They shed 1 to 5 points after their first 860 batters faced. Negative numbers are better since a lower wOBA Against is better for pitchers.</p>
<p>Unranked pitching pitching prospects as a whole gain 6 poins in wOBA Against after their first 215 batters faced and 4 points after their first 860 batters faced.</p>
<p>In addition to not improving as a group, unranked prospects fall out of the league at a much higher rate than ranked prospects, as noted earlier.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="pic_Frank_Thomas_Getty_Images.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Frank Thomas, Credit: Getty Images</figcaption>
</figure>
</div>
</section>
<section id="respect-greatness" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="respect-greatness"><span class="header-section-number">8.6</span> Respect Greatness</h2>
<p>Batters who post a career wOBA of .370 or higher and pitchers who post a career wOBA Against of .309 or lower are extremely rare. On average, about two batters and two pitchers with these career wOBA/wOBA Against marks emerge each year.</p>
<p>These marks are not perfect in capturing “great” players in real life and even less so for fantasy. They also include a small number of active players whose final career wOBA/wOBA Against is subject to fluctuate, but these marks provide a relative idea of the rarity of “great” players.</p>
<p>In dynasty leagues, managers are apt to rebuild and retool for the future when they feel that their team in its current state is not good enough to compete for a championship. Trading away talented major league players to contending teams for top prospects or very young major league players is often the strategy that goes along with this.</p>
<p>To trade a great player away in an effort to rebuild, especially when that great player is still in their prime, is an action that should be rarely and gravely taken.</p>
<p>Of prospects who debut, the percentage that put up a “great” career wOBA or wOBA Against are:</p>
<ul>
<li>A little less than 15% of top 50 batting prospects</li>
<li>About 1 to 2% of batting prospects ranked 51 to 100</li>
<li>About 25% of top 25 pitching prospects</li>
<li>A little less than 10% of pitching prospects ranked 26 to 100</li>
</ul>
<p>If you are simply trying to net a future “great” player in return, your chances are not high, especially if you are not getting many prospects back in the deal. This is why so many dynasty fantasy analysts advocate getting some young established major league talent in deals like this as opposed to only prospects.</p>
<p>Clearly, this is an oversimplification. The calculus for determining trade value is complex and player/league-dependent. However, this general concept emphasizes how serious a matter it is to trade away a great player.</p>
<p>On the other hand, trying to obtain a great player through a trade for top prospects may be worth pursuing. You’re likely to get burned some, for even great players are subject to aging curves and becoming shells of their former glory. Yet the adage resounds: “Prospects get churned, heroes get remembered, but legends never die.”</p>
</section>
<section id="in-summary" class="level2" data-number="8.7">
<h2 data-number="8.7" class="anchored" data-anchor-id="in-summary"><span class="header-section-number">8.7</span> In Summary</h2>
<p>I summarized the project in this way because I wanted it to be framed as actionable. Yet as I noted previously, this project was a descriptive analysis—not predictive. To assume that these findings apply now and will continue into the future is not entirely accurate, but I will reference Ariel Cohen’s quote one last time.</p>
<blockquote class="blockquote">
<p>“From an actuary’s perspective, the key motto for statistical models is that the past is predictive of the future. In my field, we base quantitative predictions on the tenet that given the same long-term conditions, past numerical outcomes and distributions (if properly parameterized) will continue for the foreseeable future.”</p>
</blockquote>
<p>We do not have a statistical model, but looking into the past in this descriptive way is a helpful starting point.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./07_correlation.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Correlation and Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./09_project_process.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Project Process</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>